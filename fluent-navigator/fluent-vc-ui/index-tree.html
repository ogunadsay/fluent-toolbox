<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Catalogue Network Location Visualizer</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        #visualization {
            width: 100%;
            height: 900px;
            border: 1px solid #ccc;
            overflow: auto;
        }
        .node circle {
            fill: #fff;
            stroke: steelblue;
            stroke-width: 3px;
        }
        .node text {
            font: 12px sans-serif;
        }
        .link {
            fill: none;
            stroke: #ccc;
            stroke-width: 2px;
        }
        .retailer circle { fill: #fd8d3c; }
        .virtualcatalogue circle { fill: #74c476; }
        .network circle { fill: #9e9ac8; }
        .location circle { fill: #6baed6; }
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
            pointer-events: none;
            font-size: 14px;
            max-width: 300px;
        }
        
        /* Styles for collapse/expand indicators */
        .node--has-children circle {
            cursor: pointer;
        }
        
        /* Style for the expand/collapse indicator */
        .collapse-indicator {
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            dominant-baseline: middle;
            text-anchor: middle;
        }
        
        /* Added styles for input section */
        .input-section {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        #json-input {
            width: 100%;
            height: 200px;
            padding: 10px;
            font-family: monospace;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
        }
        
        button {
            padding: 8px 16px;
            background-color: #0d6efd;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background-color: #0b5ed7;
        }
        
        #reset-btn {
            background-color: #dc3545;
        }
        
        #reset-btn:hover {
            background-color: #bb2d3b;
        }
    </style>
</head>
<body>
    <h1>Virtual Catalogue Network Location Visualizer</h1>

    <!-- Added input section -->
    <div class="input-section">
        <textarea id="json-input" placeholder="Paste your JSON data here...">{
            "name": "Retailers",
            "children": [
              {
                "name": "ae",
                "children": [
                  {
                    "name": "ME BASE SA Stores Virtual Catalog",
                    "ref": "VC:ME:BASE:STORES_SA",
                    "children": [
                      {
                        "name": "me_SA",
                        "children": [
                          {
                            "name": "SA004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA011",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME BASE AE Stores Virtual Catalog",
                    "ref": "VC:ME:BASE:STORES_AE",
                    "children": [
                      {
                        "name": "me_AE",
                        "children": [
                          {
                            "name": "AE072",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE071",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE007",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE006",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE005",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE009",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME BASE Presales Virtual Catalog",
                    "ref": "VC:ME:BASE:PRESALES",
                    "children": [
                      {
                        "name": "me_PR",
                        "children": [
                          {
                            "name": "PRE010",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME SA AGGR RETAIL Virtual Catalog",
                    "ref": "VC:ME_SA:AGGR:RETAIL",
                    "children": [
                      {
                        "name": "me_sa_WH",
                        "children": [
                          {
                            "name": "SAECO",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      },
                      {
                        "name": "me_sa_LT",
                        "children": [
                          {
                            "name": "SA004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME SA BASE RETAIL Virtual Catalog",
                    "ref": "VC:ME_SA:BASE:RETAIL",
                    "children": [
                      {
                        "name": "me_sa_WH",
                        "children": [
                          {
                            "name": "SAECO",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      },
                      {
                        "name": "me_sa_LT",
                        "children": [
                          {
                            "name": "SA004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME SA AGGR ECO Virtual Catalog",
                    "ref": "VC:ME_SA:AGGR:ECO",
                    "children": [
                      {
                        "name": "me_sa_WH",
                        "children": [
                          {
                            "name": "SAECO",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      },
                      {
                        "name": "me_sa_LT",
                        "children": [
                          {
                            "name": "SA004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME SA BASE ECO Virtual Catalog",
                    "ref": "VC:ME_SA:BASE:ECO",
                    "children": [
                      {
                        "name": "me_sa_WH",
                        "children": [
                          {
                            "name": "SAECO",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      },
                      {
                        "name": "me_sa_LT",
                        "children": [
                          {
                            "name": "SA004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME AE AGGR RETAIL Virtual Catalog",
                    "ref": "VC:ME_AE:AGGR:RETAIL",
                    "children": [
                      {
                        "name": "me_ae_WH",
                        "children": [
                          {
                            "name": "AE201",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      },
                      {
                        "name": "me_ae_LT",
                        "children": [
                          {
                            "name": "AE004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME AE BASE RETAIL Virtual Catalog",
                    "ref": "VC:ME_AE:BASE:RETAIL",
                    "children": [
                      {
                        "name": "me_ae_WH",
                        "children": [
                          {
                            "name": "AE201",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      },
                      {
                        "name": "me_ae_LT",
                        "children": [
                          {
                            "name": "AE004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME AE AGGR ECO Virtual Catalog",
                    "ref": "VC:ME_AE:AGGR:ECO",
                    "children": [
                      {
                        "name": "me_ae_WH",
                        "children": [
                          {
                            "name": "AE201",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      },
                      {
                        "name": "me_ae_LT",
                        "children": [
                          {
                            "name": "AE004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "ME AE BASE ECO Virtual Catalog",
                    "ref": "VC:ME_AE:BASE:ECO",
                    "children": [
                      {
                        "name": "me_ae_WH",
                        "children": [
                          {
                            "name": "AE201",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      },
                      {
                        "name": "me_ae_LT",
                        "children": [
                          {
                            "name": "AE004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "AE BASE SA Stores Virtual Catalog",
                    "ref": "VC:AE:BASE:STORES_SA",
                    "children": [
                      {
                        "name": "ae_SA",
                        "children": [
                          {
                            "name": "SA002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "SA011",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "AE ATS Warehouse Retail Virtual Catalog",
                    "ref": "VC:AE:ATS:WH_RETAIL",
                    "children": [
                      {
                        "name": "ae_WH",
                        "children": [
                          {
                            "name": "AE201",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "AE BASE Warehouse Retail Virtual Catalog",
                    "ref": "VC:AE:BASE:WH_RETAIL",
                    "children": [
                      {
                        "name": "ae_WH",
                        "children": [
                          {
                            "name": "AE201",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "AE ATS Warehouse Virtual Catalog",
                    "ref": "VC:AE:ATS:WH",
                    "children": [
                      {
                        "name": "ae_WH",
                        "children": [
                          {
                            "name": "AE201",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "AE  BASE Presales Virtual Catalog",
                    "ref": "VC:AE:BASE:PRESALES",
                    "children": [
                      {
                        "name": "ae_PR",
                        "children": [
                          {
                            "name": "PRE010",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "AE  BASE AE Stores Virtual Catalog",
                    "ref": "VC:AE:BASE:STORES_AE",
                    "children": [
                      {
                        "name": "ae_AE",
                        "children": [
                          {
                            "name": "AE072",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE071",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE007",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE006",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE005",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE009",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE003",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "AE001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "AE  BASE Warehouse Virtual Catalog",
                    "ref": "VC:AE:BASE:WH",
                    "children": [
                      {
                        "name": "ae_WH",
                        "children": [
                          {
                            "name": "AE201",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "name": "us",
                "children": [
                  {
                    "name": "US BASE MX Stores Virtual Catalog",
                    "ref": "VC:US:BASE:STORES_MX",
                    "children": [
                      {
                        "name": "us_MX",
                        "children": [
                          {
                            "name": "MX007",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "MX006",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "MX005",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "MX003",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "MX004",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "MX001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US BASE BR Stores Virtual Catalog",
                    "ref": "VC:US:BASE:STORES_BR",
                    "children": [
                      {
                        "name": "us_BR",
                        "children": [
                          {
                            "name": "BR002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "BR001",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US ATS Warehouse Virtual Catalog RETAIL",
                    "ref": "VC:US:ATS:WH_RETAIL",
                    "children": [
                      {
                        "name": "us_WH",
                        "children": [
                          {
                            "name": "1ZA19",
                            "type": "WAREHOUSE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US ATS Warehouse Virtual Catalog",
                    "ref": "VC:US:ATS:WH",
                    "children": [
                      {
                        "name": "us_WH",
                        "children": [
                          {
                            "name": "1ZA19",
                            "type": "WAREHOUSE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US ATS LT Virtual Catalogue RETAIL",
                    "ref": "VC:US:ATS:LT_RETAIL",
                    "children": [
                      {
                        "name": "us_LT",
                        "children": [
                          {
                            "name": "1TX04",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX05",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1IL41",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1PA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1VA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA07",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1MN61",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1AZ01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA12",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY07",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL34",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY81",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY04",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY05",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NV03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NV02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NV01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NJ01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1MA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1IL01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1GA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL32",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1DC01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA11",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA05",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US ATS LDC Virtual Catalogue RETAIL",
                    "ref": "VC:US:ATS:LDC_RETAIL",
                    "children": [
                      {
                        "name": "us_LDC",
                        "children": [
                          {
                            "name": "1ZA14",
                            "type": "WAREHOUSE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US BASE LDC Virtual Catalog RETAIL",
                    "ref": "VC:US:BASE:LDC_RETAIL",
                    "children": [
                      {
                        "name": "us_LDC",
                        "children": [
                          {
                            "name": "1ZA14",
                            "type": "WAREHOUSE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US BASE Warehouse Virtual Catalog RETAIL",
                    "ref": "VC:US:BASE:WH_RETAIL",
                    "children": [
                      {
                        "name": "us_WH",
                        "children": [
                          {
                            "name": "1ZA19",
                            "type": "WAREHOUSE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US BASE PRESALES Virtual Catalog",
                    "ref": "VC:US:BASE:PRESALES",
                    "children": [
                      {
                        "name": "us_PR",
                        "children": [
                          {
                            "name": "PRE002",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US ATS LDC Virtual Catalogue",
                    "ref": "VC:US:ATS:LDC",
                    "children": [
                      {
                        "name": "us_LDC",
                        "children": [
                          {
                            "name": "1ZA14",
                            "type": "WAREHOUSE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US BASE LDC Virtual Catalog",
                    "ref": "VC:US:BASE:LDC",
                    "children": [
                      {
                        "name": "us_LDC",
                        "children": [
                          {
                            "name": "1ZA14",
                            "type": "WAREHOUSE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US BASE USA Stores Virtual Catalog",
                    "ref": "VC:US:BASE:STORES_USA",
                    "children": [
                      {
                        "name": "us_USA",
                        "children": [
                          {
                            "name": "1TX04",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX05",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1IL41",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1PA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA08",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1ZA04",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1ZA13",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1GA02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1ZA15",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1MI01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1VA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY73",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1MA31",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1MN61",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1AZ01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA12",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "106USSFC02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "150USAVE01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA41",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY07",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL34",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY08",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA31",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX31",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1OH31",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY82",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY81",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY72",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY71",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY31",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY04",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY05",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NV03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NV02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NV01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NJ01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1MA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1IL01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1HI02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1HI01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1GA31",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1GA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL33",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL32",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL31",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1DC01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CO01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA11",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA06",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA05",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US ATS LT Virtual Catalogue",
                    "ref": "VC:US:ATS:LT",
                    "children": [
                      {
                        "name": "us_LT",
                        "children": [
                          {
                            "name": "1TX04",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX05",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1IL41",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1PA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1VA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA07",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1MN61",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1AZ01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA12",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY07",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL34",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY81",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY04",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY05",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NY03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NV03",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NV02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NV01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1NJ01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1MA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1IL01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1TX01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1GA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL32",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1FL01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1DC01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA11",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA05",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA02",
                            "type": "STORE",
                            "status": "ACTIVE"
                          },
                          {
                            "name": "1CA01",
                            "type": "STORE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "US BASE Warehouse Virtual Catalog",
                    "ref": "VC:US:BASE:WH",
                    "children": [
                      {
                        "name": "us_WH",
                        "children": [
                          {
                            "name": "1ZA19",
                            "type": "WAREHOUSE",
                            "status": "ACTIVE"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }</textarea>
        <div class="button-group">
            <button id="visualize-btn">Visualize</button>
            <button id="reset-btn">Reset</button>
        </div>
    </div>

    <div id="visualization"></div>

    <script>
        // Initialize visualization on button click instead of on load
        document.getElementById('visualize-btn').addEventListener('click', function() {
            const jsonInput = document.getElementById('json-input').value.trim();
            if (!jsonInput) {
                alert('Please paste JSON data in the textarea.');
                return;
            }
            
            try {
                const data = JSON.parse(jsonInput);
                // Clear existing visualization
                document.getElementById('visualization').innerHTML = '';
                // Create visualization with parsed data
                createVisualization(data);
            } catch (error) {
                console.error('Error parsing JSON:', error);
                alert('Invalid JSON format. Please check your input.');
            }
        });
        
        // Reset button functionality
        document.getElementById('reset-btn').addEventListener('click', function() {
            document.getElementById('json-input').value = '';
            document.getElementById('visualization').innerHTML = '';
        });

        function createVisualization(data) {
            // Set up dimensions
            const width = 1800;
            const height = 1000;
            const margin = { top: 60, right: 120, bottom: 60, left: 120 };
            
            // Function to collapse node and all its children
            function collapse(d) {
                if (d.children) {
                    d._children = d.children;
                    d._children.forEach(collapse);
                    d.children = null;
                }
            }
            
            // Function to expand a node (only one level)
            function expand(d) {
                if (d._children) {
                    d.children = d._children;
                    d._children = null;
                }
            }
            
            // Function to toggle node expansion state
            function toggleNode(d) {
                if (d.children) {
                    collapse(d);
                } else if (d._children) {
                    expand(d);
                }
                update(d);
            }
            
            // Create a hierarchy from the data
            const root = d3.hierarchy(data);
            
            // Collapse all retailers by default
            root.children.forEach(collapse);
            
            // Initial position
            root.x0 = height / 2;
            root.y0 = 0;
            
            // Create SVG
            const svg = d3.select("#visualization")
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            // Create a tooltip
            const tooltip = d3.select("body")
                .append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);
                
            // Main update function that refreshes the visualization
            function update(source) {
                // Create a cluster layout
                const cluster = d3.cluster()
                    .size([height - margin.top - margin.bottom, width - margin.left - margin.right]);
                
                // Compute the new tree layout
                const nodes = root.descendants();
                const links = root.links();
                cluster(root);
                
                // Normalize for fixed-depth
                nodes.forEach(d => {
                    d.y = d.depth * 180;
                });
                
                // Update the nodes
                const node = svg.selectAll(".node")
                    .data(nodes, d => d.id || (d.id = ++nodeId));
                
                // Enter new nodes
                const nodeEnter = node.enter().append("g")
                    .attr("class", d => {
                        let classNames = "node";
                        if (d.depth === 0) classNames += " root";
                        else if (d.depth === 1) classNames += " retailer";
                        else if (d.depth === 2) classNames += " virtualcatalogue";
                        else if (d.depth === 3) classNames += " network";
                        else classNames += " location";
                        
                        if (d.children || d._children) classNames += " node--has-children";
                        return classNames;
                    })
                    .attr("transform", d => `translate(${source.y0},${source.x0})`)
                    .on("click", function(event, d) {
                        if (d.children || d._children) {
                            toggleNode(d);
                        }
                    });
                
                // Add circles to new nodes
                nodeEnter.append("circle")
                    .attr("r", d => 10 - d.depth * 1.5)
                    .on("mouseover", function(event, d) {
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        
                        let tooltipContent = `<strong>${d.data.name}</strong>`;
                        if (d.data.ref) tooltipContent += `<br>Ref: ${d.data.ref}`;
                        if (d.data.type) tooltipContent += `<br>Type: ${d.data.type}`;
                        if (d.data.status) tooltipContent += `<br>Status: ${d.data.status}`;
                        
                        tooltip.html(tooltipContent)
                            .style("left", (event.pageX + 15) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function() {
                        tooltip.transition()
                            .duration(500)
                            .style("opacity", 0);
                    });
                
                // Add expand/collapse indicators
                nodeEnter.append("text")
                    .attr("class", "collapse-indicator")
                    .attr("x", 0)
                    .attr("y", 0)
                    .attr("dy", "0.3em")
                    .text(d => (d.children || d._children) ? (d.children ? "-" : "+") : "")
                    .style("fill-opacity", d => (d.children || d._children) ? 1 : 0);
                
                // Add labels to new nodes
                nodeEnter.append("text")
                    .attr("dy", ".31em")
                    .attr("x", d => d.children ? -15 : 15)
                    .style("text-anchor", d => d.children ? "end" : "start")
                    .text(d => {
                        // Truncate long names
                        const name = d.data.name;
                        return name.length > 20 ? name.substring(0, 17) + '...' : name;
                    });
                
                // Update existing nodes
                const nodeUpdate = nodeEnter.merge(node);
                
                nodeUpdate.transition()
                    .duration(750)
                    .attr("transform", d => `translate(${d.y},${d.x})`);
                
                nodeUpdate.select(".collapse-indicator")
                    .text(d => (d.children || d._children) ? (d.children ? "-" : "+") : "");
                
                // Remove exiting nodes
                const nodeExit = node.exit().transition()
                    .duration(750)
                    .attr("transform", d => `translate(${source.y},${source.x})`)
                    .remove();
                
                // Update the links
                const link = svg.selectAll(".link")
                    .data(links, d => d.target.id);
                
                // Enter new links
                link.enter().insert("path", "g")
                    .attr("class", "link")
                    .attr("d", d => {
                        const o = { x: source.x0, y: source.y0 };
                        return `M${o.y},${o.x}
                                C${(o.y + o.y) / 2},${o.x}
                                 ${(o.y + o.y) / 2},${o.x}
                                 ${o.y},${o.x}`;
                    })
                    .transition()
                    .duration(750)
                    .attr("d", d => {
                        return `M${d.target.y},${d.target.x}
                                C${(d.target.y + d.source.y) / 2},${d.target.x}
                                 ${(d.target.y + d.source.y) / 2},${d.source.x}
                                 ${d.source.y},${d.source.x}`;
                    });
                
                // Update existing links
                link.transition()
                    .duration(750)
                    .attr("d", d => {
                        return `M${d.target.y},${d.target.x}
                                C${(d.target.y + d.source.y) / 2},${d.target.x}
                                 ${(d.target.y + d.source.y) / 2},${d.source.x}
                                 ${d.source.y},${d.source.x}`;
                    });
                
                // Remove exiting links
                link.exit().transition()
                    .duration(750)
                    .attr("d", d => {
                        const o = { x: source.x, y: source.y };
                        return `M${o.y},${o.x}
                                C${(o.y + o.y) / 2},${o.x}
                                 ${(o.y + o.y) / 2},${o.x}
                                 ${o.y},${o.x}`;
                    })
                    .remove();
                
                // Store the old positions for transition
                nodes.forEach(d => {
                    d.x0 = d.x;
                    d.y0 = d.y;
                });
            }
            
            // Initialize counter for node IDs
            let nodeId = 0;
            
            // Initialize the visualization
            update(root);
            
            // Add zoom capabilities
            const zoom = d3.zoom()
                .scaleExtent([0.5, 3])
                .on("zoom", (event) => {
                    svg.attr("transform", event.transform);
                });
            
            d3.select("#visualization svg")
                .call(zoom);
        }
    </script>
</body>
</html>
